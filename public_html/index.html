<html lang="en" >
<head>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta content="text/html;charset=utf-8" http-equiv="Content-Type"/>
  <!-- Angular Material style sheet -->
  <link rel="stylesheet" href="resources/css/app.css">
  
  <!-- Angular Material style sheet -->
  <link rel="stylesheet" href="bower_components/angular-material/angular-material.min.css">
  
  <!-- js utils -->
  <script src="utils/StringUtils.js"></script>
  <script src="utils/AppUtils.js"></script>
  <script src="bower_components/moment/moment.js"></script>
    
  <!-- icons -->
  <link rel="stylesheet" href="resources/iconfont/material-icons.css">
  
  <!-- Angular Material requires Angular.js Libraries -->
  <script src="bower_components/angular/angular.min.js"></script>
  <script src="bower_components/angular-ui-router/release/angular-ui-router.min.js"></script>
  <script src="bower_components/angular-animate/angular-animate.min.js"></script>
  <script src="bower_components/angular-aria/angular-aria.min.js"></script>
  <script src="bower_components/angular-messages/angular-messages.min.js"></script>
  <script src="bower_components/angular-sanitize/angular-sanitize.min.js"></script>
  <script src="bower_components/ng-file-upload/ng-file-upload.min.js"></script>

  <!-- Angular Material Library -->
  <script src="bower_components/angular-material/angular-material.min.js"></script>
  
  <!-- OL2 -->
  <!--<script src="bower_components/ol2-bower/OpenLayers.js"></script>-->
  <!--<script type="text/javascript" src="resources/OL_2_11/OpenLayers.js?v1"></script>-->
  <script type="text/javascript" src="resources/OL_2_13_2/OpenLayers.2.13.2.full.js?v1"></script>
  
  <!-- google map -->
  <script type="text/javascript" src="https://maps.google.com/maps/api/js?v=3.5&sensor=false&key=AIzaSyA2CYrnwxRC5VMXPini86J680mwCI0AWfI"></script>
  
  <!-- Application bootstrap  -->
  <script type="text/javascript">
      
    var params = getSearchParameters();
    var orgId = parseInt(params.orgId);
      
    var myMapApp = angular.module('MyMapApp', ['ngMaterial', 'ngAnimate', 'ngFileUpload', 'ngSanitize', 'ui.router']);
    
    myMapApp.config(function($mdDateLocaleProvider, $mdThemingProvider) {
        
        $mdThemingProvider.theme('default')
                            .primaryPalette('blue-grey', {
                                'default': '700' // by default use shade 400 from the pink palette for primary intentions
                              })
                            .accentPalette('orange');
        
        $mdDateLocaleProvider.formatDate = function(date) {
            if(date){
                return moment(date).format('DD MM YYYY');
            }else{
                return null;
            }
        },
        $mdDateLocaleProvider.parseDate = function(date) {
            if(date){
                console.log(date);
                return null;
            }else{
                return null;
            }
        }
    });
    
    
    
  </script>
  
  <!-- Angular Services -->
  <script src="services/MapUtils.js"></script>
  <script src="services/MapService.js?v1.01"></script>
  <script src="services/MapToolsService.js?v1"></script>
  
  <!-- Angular Controllers -->
  <script src="controllers/TestController.js"></script>
  <script src="controllers/MapController.js"></script>
  <script src="controllers/BaseLayersController.js"></script>
  <script src="controllers/Layers4EditController.js"></script>
  <script src="controllers/LayerObjectEditorController.js"></script>
  <script src="controllers/AppController.js"></script>
  <script src="controllers/LoginController.js"></script>
  
  <script type="text/javascript">
    var urlSuffix = '?'+new Date().getTime();
    
    myMapApp.config(['$stateProvider', '$urlRouterProvider', function($stateProvider, $urlRouterProvider) {
        //$urlRouterProvider.otherwise('/');

        $stateProvider.state('map', {
            views: {
                "mapView": {
                    templateUrl: 'pages/map.html?v'+urlSuffix,
                    controller: 'mapController'
                },
                "mapView.baseLayersView": {
                    templateUrl: 'pages/base-layers-view.html?v'+urlSuffix,
                    controller: 'baseLayersController'
                },
                "mapView.layers4EditView": {
                    templateUrl: 'pages/layers-4-edit-view.html?v'+urlSuffix,
                    controller: 'layers4EditController'
                },
                "mapView.layerObjectEditorView": {
                    templateUrl: 'pages/layer-object-editor-view.html?v'+urlSuffix,
                    controller: 'layerObjectEditorController'
                }
            }
        }).state('login', {
            views: {
                "loginView": {
                    templateUrl: 'pages/login.html?v'+urlSuffix,
                    controller: 'loginController'
                }
            }
        });
            
    }]);

  </script>
  
  
</head>
<body ng-app="MyMapApp" ng-cloak ng-controller="appController">
  
  <div class="view-animate-container">
    <div ui-view="mapView" class="view-animate"></div>
    <div ui-view="loginView" class="view-animate"></div>
  </div>
  
</body>
</html>